<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VocaFlip: Vocabulary Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
@import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');

body {
  margin:0;
  font-family: 'Comic Neue', cursive;
  background: #f5f7fa;
  display: flex;
  flex-direction: column;
  align-items: center;
}
h1 {
  color:#c4161c;
  font-size:3rem;
  margin:0.5rem;
  text-align:center;
}
h2 {
  color:#003a8f;
  font-size:1.5rem;
  margin:0.2rem;
  text-align:center;
}
.main{
  width:100%;
  max-width:1400px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:1rem;
}
#rules{
  background:#fff;
  padding:1rem;
  border-radius:10px;
  font-size:1.2rem;
  width:90%;
}
#teacherPanel{
  display:flex;
  flex-wrap:wrap;
  gap:0.5rem;
  width:90%;
  justify-content:flex-start;
  margin-top:1rem;
}
.wordRow{
  display:flex;
  gap:0.5rem;
  margin-bottom:0.3rem;
}
.wordRow input{
  font-size:1.1rem;
  padding:0.5rem;
  border-radius:8px;
  border:1px solid #ccc;
}
.wordInput{width:120px;}
.meaningInput{width:300px;}
button{
  font-size:1.2rem;
  padding:0.6rem 1rem;
  border:none;
  border-radius:8px;
  background:#003a8f;
  color:white;
  cursor:pointer;
  margin-top:0.5rem;
}
button:hover{background:#c4161c;}
#teams{
  display:flex;
  gap:1rem;
  margin-top:1rem;
  font-size:1.3rem;
  flex-wrap:wrap;
}
.team{
  padding:0.5rem 1rem;
  border-radius:12px;
  background:#ddd;
  cursor:pointer;
  font-size:1.4rem;
}
.team.current{
  background:#003a8f;
  color:white;
  font-weight:700;
  transform: scale(1.1);
  transition: transform 0.3s;
}
#numberedBoxes{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(70px,1fr));
  gap:0.5rem;
  width:90%;
  margin-top:1rem;
}
.numberBox{
  background:linear-gradient(45deg,#ff7eb3,#ff758c);
  color:white;
  font-size:1.5rem;
  font-weight:bold;
  border-radius:12px;
  padding:1rem;
  text-align:center;
  cursor:pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
.numberBox.selected{
  background:green;
  transform: scale(1.1);
}
.numberBox:hover{
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
}
#meaningPanel{
  margin-top:1rem;
  background:#003a8f;
  color:white;
  border-radius:12px;
  padding:1rem;
  font-size:1.5rem;
  width:90%;
  max-width:800px;
  min-height:120px;
  display:none;
  flex-direction:column;
  align-items:center;
  gap:0.5rem;
  text-align:center;
}
.choiceBtn{
  padding:0.7rem 1rem;
  border:none;
  border-radius:12px;
  font-size:1.4rem;
  cursor:pointer;
  transition: transform 0.2s;
}
.choiceBtn:hover{
  transform: scale(1.05);
}
.correct{background:#28a745; color:white;}
.wrong{background:#dc3545; color:white;}
#feedback{
  margin-top:1rem;
  font-size:1.4rem;
  min-height:30px;
  text-align:center;
}
</style>
</head>
<body>

<h1>ðŸŒ¸ VocaFlip ðŸŒ¸</h1>
<h2>VUS Hoa Binh Campus</h2>

<div class="main">

<div id="rules">
<strong>Rules:</strong>
<ol>
<li>Teacher enters words and meanings in the panel below (Word Box then Meaning Box).</li>
<li>Students choose a numbered box.</li>
<li>The meaning appears along with 3 answer choices.</li>
<li>Students pick the correct answer. Teacher clicks it to reveal correctness.</li>
<li>Correct = +10 points, wrong = 0 points.</li>
<li>Teams take turns selecting boxes until all boxes are used.</li>
</ol>
</div>

<h2>Enter Words</h2>
<div id="teacherPanel">
<!-- Word boxes will be added dynamically -->
</div>
<button onclick="addQuestion()">+ Add Question</button>
<button onclick="startGame()">Start Game</button>

<h2>Teams</h2>
<div id="teamInputs">
<input type="text" value="Team 1" id="team1">
<input type="text" value="Team 2" id="team2">
<input type="text" value="Team 3" id="team3">
</div>
<div id="teams"></div>

<div id="numberedBoxes"></div>

<div id="meaningPanel">
<div id="meaningText"></div>
<div id="choicesContainer" style="display:flex; gap:0.5rem; flex-wrap:wrap; justify-content:center;"></div>
</div>

<div id="feedback"></div>
<button onclick="restartGame()">Restart</button>

</div>

<!-- Sounds -->
<audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3"></audio>
<audio id="wrongSound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<script>
let questions=[], teams=[], scores=[], selectedTeam=null;
let currentQuestion=null;

function addQuestion(){
  const panel = document.getElementById("teacherPanel");
  const row = document.createElement("div");
  row.className="wordRow";

  const wordInput = document.createElement("input");
  wordInput.type="text";
  wordInput.placeholder="Word";
  wordInput.className="wordInput";

  const meaningInput = document.createElement("input");
  meaningInput.type="text";
  meaningInput.placeholder="Meaning";
  meaningInput.className="meaningInput";

  row.appendChild(wordInput);
  row.appendChild(meaningInput);
  panel.appendChild(row);
}

function startGame(){
  const panel = document.getElementById("teacherPanel");
  const rows = panel.querySelectorAll(".wordRow");
  questions=[];
  rows.forEach(r=>{
    const word = r.querySelector(".wordInput").value.trim();
    const meaning = r.querySelector(".meaningInput").value.trim();
    if(word && meaning) questions.push({word, meaning, revealed:false});
  });
  if(questions.length===0) return alert("Enter at least one word and meaning!");

  // Shuffle questions
  for(let i=questions.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [questions[i],questions[j]]=[questions[j],questions[i]];
  }

  // Teams
  teams = [document.getElementById("team1").value||"Team 1",
           document.getElementById("team2").value||"Team 2",
           document.getElementById("team3").value||"Team 3"].filter(t=>t!=="");
  scores = teams.map(_=>0);
  selectedTeam = null;

  renderTeams();
  renderNumberedBoxes();
  document.getElementById("teacherPanel").style.display="none";
  document.getElementById("teamInputs").style.display="none";
}

function renderTeams(){
  const div = document.getElementById("teams");
  div.innerHTML="";
  teams.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="team"+(i===selectedTeam?" current":"");
    d.textContent = `${t}: ${scores[i]} pts`;
    d.onclick=()=>{ selectedTeam=i; renderTeams(); }
    div.appendChild(d);
  });
}

function renderNumberedBoxes(){
  const div = document.getElementById("numberedBoxes");
  div.innerHTML="";
  questions.forEach((q,i)=>{
    const box = document.createElement("div");
    box.className="numberBox";
    box.textContent=i+1;
    box.onclick=()=> selectQuestion(i, box);
    div.appendChild(box);
  });
}

function selectQuestion(index, box){
  if(!selectedTeam) return alert("Select a team first!");
  if(questions[index].revealed) return;
  // Highlight selected box
  document.querySelectorAll(".numberBox").forEach(b=>b.classList.remove("selected"));
  box.classList.add("selected");

  currentQuestion=index;
  showMeaningPanel(questions[index]);
}

function showMeaningPanel(question){
  const panel = document.getElementById("meaningPanel");
  panel.style.display="flex";
  document.getElementById("meaningText").textContent=question.meaning;

  // Prepare 3 choices
  const container = document.getElementById("choicesContainer");
  container.innerHTML="";
  let choices = [question.word];

  // pick 2 random wrong words
  const wrongs = questions.filter(q=>q.word!==question.word).map(q=>q.word);
  for(let i=0;i<2;i++){
    const w = wrongs.splice(Math.floor(Math.random()*wrongs.length),1)[0];
    choices.push(w);
  }

  // Shuffle choices
  for(let i=choices.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [choices[i],choices[j]]=[choices[j],choices[i]];
  }

  choices.forEach(c=>{
    const btn = document.createElement("button");
    btn.className="choiceBtn";
    btn.textContent=c;
    btn.onclick=()=> handleChoice(btn, question);
    container.appendChild(btn);
  });
}

function handleChoice(btn, question){
  if(question.revealed) return;
  if(btn.textContent===question.word){
    btn.classList.add("correct");
    scores[selectedTeam]+=10;
    document.getElementById("feedback").textContent="âœ… Correct! +10 points";
    document.getElementById("correctSound").play();
    confetti({particleCount: 50, spread: 60, origin:{y:0.6}});
  } else {
    btn.classList.add("wrong");
    document.getElementById("feedback").textContent=`âŒ Wrong! The word was: ${question.word}`;
    document.getElementById("wrongSound").play();
  }
  question.revealed=true;
  renderTeams();

  // Remove box highlight
  document.querySelectorAll(".numberBox")[currentQuestion].classList.add("revealed");

  // Check for final winner
  if(questions.every(q=>q.revealed)){
    document.getElementById("feedback").textContent += " ðŸŽ‰ All questions answered! ðŸŽ‰";
    confetti({particleCount: 300, spread: 150, origin:{y:0.6}});
  }
}

function restartGame(){ window.location.reload(); }

// Initialize 5 question boxes
for(let i=0;i<5;i++) addQuestion();
</script>

</body>
</html>
