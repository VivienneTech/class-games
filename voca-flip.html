<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŒ¼ VocaFlip ðŸŒ¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#ff8fab;
  --secondary:#ffe5ec;
  --accent:#7bdff2;
  --bg:#fffafc;
}

body{
  margin:0;
  font-family:'Comic Sans MS', cursive;
  background:var(--bg);
  text-align:center;
}

h1{
  font-size:3rem;
  margin:10px;
  color:#ff4d6d;
}

button{
  font-family:inherit;
  cursor:pointer;
  border:none;
  border-radius:18px;
  padding:14px 22px;
  font-size:1.2rem;
  background:var(--primary);
  color:white;
}

input,select{
  padding:10px;
  font-size:1.1rem;
  border-radius:12px;
  border:1px solid #ccc;
}

#teacherPanel{
  background:var(--secondary);
  padding:16px;
}

.wordRow{
  display:flex;
  gap:12px;
  justify-content:center;
  margin:10px 0;
  flex-wrap:wrap;
}

.pasteBox{
  width:110px;
  height:110px;
  border:3px dashed #bbb;
  border-radius:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:white;
  font-size:0.9rem;
}
.pasteBox img{
  width:100%;
  height:100%;
  object-fit:contain;
  border-radius:14px;
}

#teams{
  margin:15px;
}
.team{
  display:inline-block;
  padding:14px 20px;
  margin:6px;
  font-size:1.2rem;
  background:var(--accent);
  border-radius:20px;
}
.team.active{
  outline:4px solid gold;
}

#board{
  display:grid;
  gap:18px;
  justify-content:center;
  margin:20px;
}

.card{
  width:130px;
  height:130px;
  background:#ffe066;
  border-radius:24px;
  font-size:2.8rem;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.card.used{
  background:#ddd;
  color:#999;
  cursor:default;
}

#popup{
  background:white;
  padding:20px;
  border-radius:26px;
  max-width:360px;
  margin:20px auto;
  box-shadow:0 12px 30px rgba(0,0,0,0.25);
}

#popup img{
  width:240px;
  height:240px;
  object-fit:contain;
  background:#f5f5f5;
  border-radius:18px;
}

.optionBtn{
  display:block;
  margin:12px auto;
  padding:16px;
  font-size:1.5rem;
  width:100%;
  background:var(--primary);
  color:white;
}
.optionBtn.correct{background:#4caf50;}
.optionBtn.wrong{background:#f44336;}
</style>
</head>

<body>

<h1>ðŸŒ¼ VocaFlip ðŸŒ¼</h1>

<div id="teacherPanel">
  Answer choices:
  <select id="choiceCount">
    <option value="2">2</option>
    <option value="3" selected>3</option>
    <option value="4">4</option>
  </select>

  <button onclick="addTeam()">âž• Add Team</button>
  <button onclick="addWord()">âž• Add Word</button>
  <button onclick="startGame()">â–¶ Start Game</button>

  <div id="words"></div>
</div>

<div id="teams"></div>
<div id="board"></div>
<div id="popup" style="display:none;"></div>

<script>
let teams=[],scores=[],currentTeam=0;
let words=[],used=[];
let gameStarted=false;

function addTeam(){
  if(gameStarted) return;
  const name=prompt("Team name:");
  if(!name) return;
  teams.push(name);
  scores.push(0);
  renderTeams();
}

function renderTeams(){
  const div=document.getElementById("teams");
  div.innerHTML="";
  teams.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="team"+(i===currentTeam?" active":"");
    d.textContent=`${t}: ${scores[i]} pts`;
    d.onclick=()=>{currentTeam=i;renderTeams();};
    div.appendChild(d);
  });
}

function addWord(){
  if(gameStarted) return;
  if(document.querySelectorAll(".wordRow").length>=30) return alert("Max 30 words");

  const row=document.createElement("div");
  row.className="wordRow";
  row.innerHTML=`
    <div class="pasteBox">ðŸ“‹ Paste Image</div>
    <input placeholder="Correct word">
  `;

  const box=row.querySelector(".pasteBox");
  box.addEventListener("paste",e=>{
    const item=[...e.clipboardData.items].find(i=>i.type.startsWith("image"));
    if(!item) return;
    const file=item.getAsFile();
    const url=URL.createObjectURL(file);
    box.innerHTML=`<img src="${url}">`;
    box.dataset.img=url;
  });

  document.getElementById("words").appendChild(row);
}

function startGame(){
  words=[];
  document.querySelectorAll(".wordRow").forEach(r=>{
    const img=r.querySelector(".pasteBox").dataset.img;
    const w=r.querySelector("input").value.trim();
    if(img&&w) words.push({img,word:w});
  });
  if(words.length<2) return alert("Add at least 2 words");
  gameStarted=true;
  used=Array(words.length).fill(false);
  renderBoard();
}

function renderBoard(){
  const board=document.getElementById("board");
  board.innerHTML="";
  const cols=Math.ceil(Math.sqrt(words.length));
  board.style.gridTemplateColumns=`repeat(${cols},130px)`;

  words.forEach((_,i)=>{
    const c=document.createElement("div");
    c.className="card"+(used[i]?" used":"");
    c.textContent=i+1;
    c.onclick=()=>{if(!used[i]) openCard(i);};
    board.appendChild(c);
  });
}

function openCard(i){
  const popup=document.getElementById("popup");
  popup.style.display="block";

  const count=parseInt(choiceCount.value);
  let options=[words[i].word];
  let pool=words.map(w=>w.word).filter(w=>w!==words[i].word);

  while(options.length<count && pool.length){
    options.push(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
  }
  options.sort(()=>Math.random()-0.5);

  popup.innerHTML=`
    <img src="${words[i].img}">
    ${options.map(o=>`<button class="optionBtn" onclick="answer('${o}','${words[i].word}',${i})">${o}</button>`).join("")}
  `;
}

function answer(choice,correct,i){
  document.querySelectorAll(".optionBtn").forEach(b=>{
    b.classList.add(b.textContent===correct?"correct":"wrong");
    b.disabled=true;
  });
  if(choice===correct){
    scores[currentTeam]+=10;
    renderTeams();
  }
  used[i]=true;
  setTimeout(()=>{
    popup.style.display="none";
    renderBoard();
  },1000);
}
</script>

</body>
</html>
