<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŒ¸ VocaFlip ðŸŒ¸</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:'Comic Sans MS', cursive;
  background:#fff0f6;
  text-align:center;
}
h1{color:#ff4d6d;margin:10px;}
button{font-family:inherit;cursor:pointer;border:none;border-radius:12px;}

#teacherPanel{
  background:#ffe5ec;
  padding:10px;
}
input,select{
  padding:6px;
  border-radius:8px;
  border:1px solid #ccc;
}
.wordRow{
  display:flex;
  gap:6px;
  justify-content:center;
  margin:4px 0;
}

#teams,#board,#options{
  margin:15px;
}

.team{
  display:inline-block;
  padding:10px 15px;
  margin:5px;
  background:#ff85a1;
  color:white;
  font-weight:bold;
}
.team.active{
  outline:4px solid gold;
}

#board{
  display:grid;
  gap:12px;
  justify-content:center;
}

.card{
  background:#ffcad4;
  border-radius:18px;
  height:90px;
  font-size:2rem;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card.used{
  background:#ddd;
  color:#999;
}

#popup{
  background:white;
  padding:15px;
  border-radius:20px;
  max-width:300px;
  margin:auto;
}
#popup img{
  width:200px;
  height:200px;
  object-fit:contain;
}

.optionBtn{
  display:block;
  margin:6px auto;
  padding:10px;
  font-size:1.2rem;
  background:#ff85a1;
  color:white;
  width:90%;
}
.optionBtn.correct{background:#4caf50;}
.optionBtn.wrong{background:#f44336;}
</style>
</head>

<body>

<h1>ðŸŒ¸ VocaFlip ðŸŒ¸</h1>

<!-- TEACHER SETUP -->
<div id="teacherPanel">
  Choices:
  <select id="choiceCount">
    <option value="2">2</option>
    <option value="3" selected>3</option>
    <option value="4">4</option>
  </select>

  <button onclick="addTeam()">Add Team</button>
  <button onclick="addWord()">Add Word</button>
  <button onclick="startGame()">Start Game</button>

  <div id="words"></div>
</div>

<div id="teams"></div>
<div id="board"></div>
<div id="popup" style="display:none;"></div>

<script>
let teams=[],scores=[],currentTeam=0;
let words=[];
let used=[];

function addTeam(){
  const name=prompt("Team name:");
  if(!name) return;
  teams.push(name);
  scores.push(0);
  renderTeams();
}

function renderTeams(){
  const div=document.getElementById("teams");
  div.innerHTML="";
  teams.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="team"+(i===currentTeam?" active":"");
    d.textContent=`${t}: ${scores[i]}`;
    d.onclick=()=>{currentTeam=i;renderTeams();}
    div.appendChild(d);
  });
}

function addWord(){
  if(words.length>=30) return alert("Max 30 words");
  const row=document.createElement("div");
  row.className="wordRow";
  row.innerHTML=`
    <input placeholder="Picture URL">
    <input placeholder="Correct word">
  `;
  document.getElementById("words").appendChild(row);
}

function startGame(){
  words=[];
  document.querySelectorAll(".wordRow").forEach(r=>{
    const img=r.children[0].value.trim();
    const w=r.children[1].value.trim();
    if(img&&w) words.push({img,word:w});
  });
  if(words.length<2) return alert("Add at least 2 words");
  used=Array(words.length).fill(false);
  renderBoard();
}

function renderBoard(){
  const board=document.getElementById("board");
  board.innerHTML="";
  const cols=Math.ceil(Math.sqrt(words.length));
  board.style.gridTemplateColumns=`repeat(${cols},90px)`;

  words.forEach((w,i)=>{
    const c=document.createElement("div");
    c.className="card"+(used[i]?" used":"");
    c.textContent=i+1;
    c.onclick=()=>{ if(!used[i]) openCard(i); };
    board.appendChild(c);
  });
}

function openCard(i){
  const popup=document.getElementById("popup");
  popup.style.display="block";

  const count=parseInt(document.getElementById("choiceCount").value);
  let options=[words[i].word];

  let pool=words.map(w=>w.word).filter(w=>w!==words[i].word);
  while(options.length<count && pool.length){
    options.push(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
  }
  options.sort(()=>Math.random()-0.5);

  popup.innerHTML=`
    <img src="${words[i].img}">
    ${options.map(o=>`<button class="optionBtn" onclick="answer('${o}','${words[i].word}',${i})">${o}</button>`).join("")}
  `;
}

function answer(choice,correct,i){
  const btns=document.querySelectorAll(".optionBtn");
  btns.forEach(b=>{
    if(b.textContent===correct) b.classList.add("correct");
    else b.classList.add("wrong");
    b.disabled=true;
  });

  if(choice===correct){
    scores[currentTeam]+=10;
    renderTeams();
  }
  used[i]=true;
  setTimeout(()=>{
    document.getElementById("popup").style.display="none";
    renderBoard();
  },800);
}
</script>

</body>
</html>
